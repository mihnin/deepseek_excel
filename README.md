# DeepSeek Excel Processor Pro

Веб-приложение для интеллектуальной обработки Excel-файлов с использованием DeepSeek LLM. Приложение позволяет загружать Excel-таблицы, выбирать стратегию анализа (построчный, табличный или комбинированный), использовать предустановленные бизнес-ориентированные промпты и получать профессиональные аналитические отчеты.

![Интерфейс приложения](images/interface.png)

## Ключевые возможности

- **Три режима анализа**: построчный анализ, анализ всей таблицы или комбинированный подход
- **Библиотека бизнес-промптов**: готовые шаблоны для различных бизнес-задач
- **Расширенный контекст**: возможность загрузки дополнительных файлов для улучшения анализа
- **Профессиональная обработка данных**: предварительная очистка и подготовка данных
- **Сохраняемые профили**: настройка и сохранение конфигураций для повторного использования
- **Надежная система повторных попыток**: механизм восстановления при сбоях API
- **Детальное логирование**: полная история взаимодействия с API
- **Бизнес-ориентированный интерфейс**: интуитивный дизайн с минимумом технических деталей

## Установка

### 1. Требования

- Python 3.10 или выше
- Действующий API-ключ DeepSeek

### 2. Установка зависимостей

```bash
# Создание виртуального окружения
python -m venv deepseek_env
source deepseek_env/bin/activate  # для Linux/Mac
# или
deepseek_env\Scripts\activate.bat  # для Windows

# Установка зависимостей
pip install -r requirements.txt
```

### 3. Запуск приложения

```bash
streamlit run app.py
```

После запуска командой выше приложение откроется в вашем браузере по адресу http://localhost:8501

## Структура проекта

```
deepseek_excel/
├── app.py                  # Главное приложение
├── modules/                # Модули проекта
│   ├── llm_integration.py  # Работа с LLM моделями
│   ├── data_processor.py   # Обработка данных
│   └── prompt_library.py   # Библиотека промптов
├── utils/                  # Утилиты
└── requirements.txt        # Зависимости
```

## Руководство пользователя

### 1. Главный экран

При первом запуске вы увидите главный экран приложения с боковой панелью для настройки и тремя основными вкладками:
- **Загрузка данных**: Загрузка Excel-файла и дополнительных контекстных файлов
- **Настройка анализа**: Конфигурация параметров обработки и выбор промптов
- **Результаты**: Просмотр и скачивание результатов анализа

### 2. Настройка API и модели

В боковой панели введите:
- **DeepSeek API Key**: Ваш API-ключ DeepSeek
- **Режим анализа**: Выберите тип обработки данных
- **Настройки модели**: Настройте параметры LLM-модели (при необходимости)

### 3. Загрузка данных

На вкладке "Загрузка данных":
1. Нажмите кнопку "Загрузите Excel файл для анализа" и выберите XLSX/XLS файл
2. После загрузки отобразится предпросмотр данных и общая статистика
3. При необходимости можно загрузить дополнительные текстовые файлы для контекста

### 4. Настройка анализа

На вкладке "Настройка анализа":
1. Выберите источник промпта — из библиотеки или задайте свой
2. При выборе из библиотеки сначала укажите категорию, затем конкретный промпт
3. В зависимости от выбранного режима настройте:
   - **Для построчного анализа**: выберите целевой столбец и дополнительные столбцы
   - **Для анализа всей таблицы**: укажите ключевые столбцы для фокуса (опционально)
   - **Для комбинированного анализа**: настройте оба варианта и порядок выполнения

### 5. Запуск обработки

На вкладке "Настройка анализа" нажмите кнопку "Запустить обработку данных" для начала анализа. Время обработки зависит от:
- Размера таблицы
- Выбранного режима
- Настроек модели

### 6. Просмотр результатов

После завершения обработки автоматически откроется вкладка "Результаты", где вы увидите:
- Результаты построчного анализа (если выбран соответствующий режим)
- Результаты анализа всей таблицы (если выбран соответствующий режим)
- Кнопки для скачивания результатов в различных форматах
- Логи обработки для диагностики возможных проблем

## Примеры использования

### Анализ отзывов клиентов

1. Загрузите Excel-таблицу с отзывами клиентов
2. Выберите режим "Построчный анализ"
3. В библиотеке промптов выберите категорию "Работа с клиентами" и промпт "Анализ отзыва"
4. Укажите столбец с отзывами как целевой
5. Добавьте столбцы с датой, рейтингом или другими метриками как дополнительные
6. Запустите обработку и получите детальный анализ каждого отзыва

### Финансовый анализ квартальной отчетности

1. Загрузите Excel с финансовыми показателями по месяцам
2. Выберите режим "Анализ всей таблицы"
3. В библиотеке промптов выберите категорию "Финансы и отчетность" и промпт "Анализ финансовых данных"
4. Укажите ключевые финансовые столбцы для фокуса
5. Запустите обработку и получите комплексный аналитический отчет с выявлением трендов и рекомендациями

### Обработка и категоризация текстов

1. Загрузите Excel с текстовыми данными для категоризации
2. Выберите режим "Комбинированный анализ"
3. В библиотеке промптов выберите "Общая аналитика: Классификация"
4. Укажите столбец с текстами как целевой
5. Запустите обработку и получите как категоризацию каждого текста, так и общую аналитику по всему массиву

## Расширенные функции

### Сохранение профилей настроек

Вы можете сохранять и загружать профили настроек через панель "Управление профилями" в боковой панели:
1. Настройте все параметры как вам нужно
2. Введите название профиля и нажмите "Сохранить профиль"
3. В будущем просто выберите сохраненный профиль и нажмите "Загрузить профиль"

### Комбинирование файлов контекста

Для улучшения качества анализа вы можете загружать дополнительные контекстные файлы:
- Текстовые документы с пояснениями или инструкциями
- CSV-файлы с дополнительными данными
- JSON-файлы с метаданными
- Markdown-файлы с описанием структуры или методологии

### Предварительная обработка данных

Приложение автоматически выполняет предварительную обработку данных:
- Очистка от дубликатов и пустых значений (опционально)
- Нормализация текстовых данных для лучшего анализа
- Определение типов столбцов и их потенциальной роли
- Выявление возможных проблем в данных (предупреждения)

## Объяснение параметров модели

### Temperature (0.0 - 2.0)
Управляет "креативностью" ответов. Низкие значения (0.2-0.5) дают более предсказуемые и консервативные результаты, высокие значения (0.8-1.5) дают более разнообразные и творческие ответы.

### Max Tokens (1 - 4000)
Максимальная длина ответа модели. Для детального анализа всей таблицы рекомендуется устанавливать высокие значения (1000-2000).

### Top P (0.0 - 1.0)
Ограничивает выбор модели только самыми вероятными вариантами. Значение 1.0 означает рассмотрение всех вариантов, 0.7-0.9 обычно дает хороший баланс между стабильностью и разнообразием.

### Frequency Penalty и Presence Penalty (0.0 - 2.0)
Эти параметры помогают избегать повторений. Для аналитических задач рекомендуется устанавливать низкие значения (0.0-0.3).

## Советы для получения лучших результатов

- **Для финансовых данных**: используйте режим с низкой Temperature (0.1-0.3) для более точных результатов
- **Для текстового анализа**: комбинируйте несколько столбцов для создания полного контекста
- **Для длинных текстов**: предпочтительнее использовать построчный анализ с высоким значением Max Tokens
- **Для сегментации данных**: используйте комбинированный анализ, начиная с анализа всей таблицы
- **Для повышения точности**: загружайте контекстные файлы с отраслевыми терминами или методологиями

## Известные ограничения

- Максимальный размер Excel-файла: ~50 МБ
- Максимальное количество строк для эффективного построчного анализа: ~1000
- Максимальная длина текста в ячейке для полного анализа: ~5000 символов
- Возможны задержки при обработке больших таблиц из-за ограничений API

## Устранение неполадок

### Ошибка API при запросе
- Проверьте корректность API-ключа
- Уменьшите значение Max Tokens
- Проверьте соединение с интернетом

### Неполные или некорректные результаты
- Увеличьте значение Max Tokens
- Добавьте больше контекста через дополнительные столбцы
- Убедитесь, что выбрали правильный столбец для анализа

### Приложение работает медленно
- Уменьшите размер загружаемого файла
- Выполняйте анализ для меньшего количества строк
- Закройте другие ресурсоемкие приложения

### Пустые значения в результатах
- Убедитесь, что входные данные не содержат ошибок
- Проверьте логи на наличие ошибок API
- Попробуйте режим анализа с механизмом повторных попыток

## План развития проекта

### Ближайшие улучшения (Q1 2025)
- Поддержка более широкого спектра форматов файлов (PDF, DOCX)
- Интеграция с другими LLM-провайдерами (OpenAI, Anthropic)
- Расширение библиотеки бизнес-промптов для новых отраслей

### Среднесрочные планы (Q2-Q3 2025)
- Визуализация результатов анализа с помощью интерактивных графиков
- Система шаблонов для автоматизации повторяющихся задач
- Интеграция с хранилищами данных (Google Sheets, Airtable)

### Долгосрочные планы (2025+)
- Коллаборативный режим для командной работы
- Расширенные функции AI для прогнозирования и моделирования
- Отраслевые решения для специфических бизнес-задач

## Вклад в проект

Если вы хотите внести свой вклад в развитие DeepSeek Excel Processor:
1. Форкните репозиторий
2. Создайте ветку с вашими изменениями
3. Отправьте пулл-реквест с описанием улучшений

## Лицензия

Данный проект распространяется под лицензией Apache 2.0. См. файл LICENSE для подробностей.

## Поддержка

При возникновении вопросов или проблем:
- Создайте Issue в репозитории проекта
- Свяжитесь с командой разработки по email: support@deepseek-excel.example.com
- 
## Тестирование приложения

### Запуск тестов

Для запуска всех тестов используйте:

```bash
python run_tests.py

Для запуска конкретного теста:

python -m unittest tests/test_excel_handler.py

Добавление новых тестов

Создайте файл в директории tests/ с именем, начинающимся с test_
Определите класс тестов, наследующийся от unittest.TestCase
Определите методы с именами, начинающимися с test_

Пример:
import unittest
from modules.your_module import YourClass

class TestYourClass(unittest.TestCase):
    def setUp(self):
        self.instance = YourClass()
    
    def test_your_method(self):
        result = self.instance.your_method(test_input)
        self.assertEqual(result, expected_output)

deepseek_excel/
├── app.py                        # Главное приложение
├── config/                       # Централизованная конфигурация
│   └── default_config.json       # Настройки по умолчанию
├── modules/                      # Модули проекта
│   ├── api_utils.py              # Новый модуль для работы с API
│   ├── data_processor.py         # Обработка данных
│   ├── excel_handler.py          # Единый модуль для работы с Excel
│   ├── file_utils.py             # Работа с файлами
│   ├── llm_integration.py        # Работа с облачными LLM
│   ├── local_llm_integration.py  # Работа с локальными LLM
│   ├── prompt_library.py         # Библиотека промптов
│   ├── unified_llm.py            # Унифицированный LLM клиент
│   └── visualization.py          # Визуализация данных
├── ui/                           # Компоненты пользовательского интерфейса
│   ├── export_view.py            # Обновленный модуль экспорта
│   ├── ...
├── utils/                        # Утилиты
│   ├── config_manager.py         # Новый менеджер конфигурации
│   └── profile_manager.py        # Управление профилями
├── tests/                        # Тесты
│   ├── test_api_utils.py         # Новый тест
│   ├── test_excel_handler.py
│   └── ...
├── docs/                         # Новая директория для документации
│   └── api/                      # Документация API
├── run_tests.py                  # Новый скрипт для запуска тестов
└── requirements.txt              # Зависимости